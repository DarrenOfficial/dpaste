{% load i18n %}

<form method="post" action="" class="form-horizontal snippet-form">
    {% csrf_token %}
    {{ form.non_field_errors }}
    <div style="display: none;">{{ form.title }}</div>

    <div class="
        control-group
        form-content
        superenter
        {% if not object %}autofocus{% endif %}
        {% if form.content.errors %}error{% endif %}
    ">
        {{ form.content }}
    </div>

    <div class="control-group form-options">
        <div class="form-options-lexer
            {% if form.lexer.errors %}control-group error{% endif %}">
            <div class="input-append">
                {{ form.lexer }}
            </div>
            {% for error in form.lexer.errors %}
            <span class="help-inline">{{ error }}</span>
            {% endfor %}
        </div>
        <div class="form-options-expire">
            {{ form.expires.errors }}
            <div class="input-prepend">
                <span class="add-on"><i class="icon-trash" title="{% trans "Expire in" %}"></i></span>
                {{ form.expires }}
            </div>
        </div>
    </div>
    <div class="form-actions">
        <input tabindex="0" type="submit"class="btn btn-primary" value="{% trans "Paste it" %}">
        <span class="shortcut">&#8984;+&#9166; {% trans "or" %} Ctrl+&#9166;</span>
    </div>
</form>

{% block script_footer %}
<script>
  var af = document.querySelector(".autofocus textarea");
  if (af !== null)
    af.focus();

  var se = document.querySelector(".superenter textarea");
  if (se !== null) {
    se.onkeydown = function(e) {
      var metaKey;
      if (navigator.appVersion.indexOf("Win") !== -1) {
        metaKey = e.ctrlKey;
      } else {
        metaKey = event.metaKey;
      }
      if (e.keyCode == 13 && metaKey) {
        document.querySelector(".snippet-form").submit();
        return false;
      }
    }
  }
</script>
{% endblock %}
